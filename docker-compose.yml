version: '3.8'

services:
  facebook-automation:
    build: .
    ports:
      - "8000:8000"
    environment:
      # Facebook Configuration
      FACEBOOK_PAGE_ID: ${FACEBOOK_PAGE_ID}
      FACEBOOK_PAGE_ACCESS_TOKEN: ${FACEBOOK_PAGE_ACCESS_TOKEN}
      
      # Gemini AI
      GEMINI_API_KEY: ${GEMINI_API_KEY}
      
      # Google Service Account (read from file)
      GOOGLE_SERVICE_ACCOUNT: ${GOOGLE_SERVICE_ACCOUNT}
      
      # API Authentication
      API_USERNAME: ${API_USERNAME:-admin}
      API_PASSWORD: ${API_PASSWORD:-admin123}
      
      # Server
      PORT: 8000
    
    restart: unless-stopped
    
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

# To use:
# 1. Create .env file with your variables
# 2. Run: docker-compose up -d
# 3. View logs: docker-compose logs -f
